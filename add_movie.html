<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Add Movie | Movie Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      background-color: #f5f5f5;
    }
    header {
      background-color: #111;
      color: #fff;
      padding: 20px;
      text-align: center;
    }
    header h1 {
      margin: 0;
    }
    header h3 {
      margin: 5px 0 15px 0;
      font-weight: 400;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      margin: 0 10px;
      font-weight: 500;
    }
    nav a:hover {
      text-decoration: underline;
    }
    main#add-movie {
      display: flex;
      flex-direction: column;
      align-items: center;
      max-width: 500px;
      margin: 40px auto;
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    input[type="text"] {
      width: 100%;
      padding: 12px;
      margin: 10px 0 20px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    button {
      background-color: #e50914;
      color: #fff;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background-color: #b00610;
    }
    #result, #error {
      margin-top: 20px;
      font-size: 14px;
      word-wrap: break-word;
    }
    #result {
      color: green;
    }
    #error {
      color: red;
    }
  </style>
</head>
<body>
  <header>
    <h1>Movie Hub</h1>
    <h3>Add a New Movie</h3>
    <nav>
      <a href="index.html">Home</a>
      <a href="movies.html">Movies</a>
      <a href="genres.html">Genres</a>
      <a href="top-rated.html">Top Rated</a>
      <a href="about.html">About</a>
    </nav>
  </header>

  <main id="add-movie">
    <input type="text" id="movieName" placeholder="Enter movie name">
    <button id="addMovieBtn">Add Movie</button>
    <div id="result"></div>
    <div id="error"></div>
  </main>

  <script>
    const button = document.getElementById("addMovieBtn");

    button.addEventListener("click", async () => {
      const name = document.getElementById("movieName").value.trim();
      const resultDiv = document.getElementById("result");
      const errorDiv = document.getElementById("error");
      resultDiv.textContent = "";
      errorDiv.textContent = "";

      if (!name) {
        errorDiv.textContent = "Please enter a movie name.";
        return;
      }

      button.disabled = true;
      button.textContent = "Adding...";

      try {
        const response = await fetch("https://player-helper.onrender.com/add_movie", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name })
        });

        const data = await response.json();

        if (data.success) {
          const movieId = data.movie_id !== undefined ? data.movie_id : "undefined";
          resultDiv.textContent = `Movie added successfully! ID: ${movieId}`;
          document.getElementById("movieName").value = "";

          // Keep the success message visible for 10 seconds
          setTimeout(() => resultDiv.textContent = "", 10000);

        } else {
          errorDiv.textContent = data.error || "Something went wrong.";
          // Keep error visible for 15 seconds
          setTimeout(() => errorDiv.textContent = "", 15000);
        }
      } catch (err) {
        errorDiv.textContent = "Error connecting to backend.";
        console.error(err);
        setTimeout(() => errorDiv.textContent = "", 10000);
      } finally {
        button.disabled = false;
        button.textContent = "Add Movie";
      }
    });
  </script>
</body>
</html>
