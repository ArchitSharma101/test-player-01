<script>
const button = document.getElementById("addMovieBtn");

button.addEventListener("click", async () => {
    const name = document.getElementById("movieName").value.trim();
    const resultDiv = document.getElementById("result");
    const errorDiv = document.getElementById("error");
    resultDiv.textContent = "";
    errorDiv.textContent = "";

    if (!name) {
        errorDiv.textContent = "Please enter a movie name.";
        return;
    }

    button.disabled = true;
    button.textContent = "Adding...";

    try {
        const response = await fetch("https://player-helper.onrender.com/add_movie", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name })
        });

        const data = await response.json();

        if (data.success) {
            const movieId = data.movie_id !== undefined ? data.movie_id : "undefined";
            resultDiv.textContent = `Movie added successfully! ID: ${movieId}`;
            document.getElementById("movieName").value = "";

            // Keep the success message visible for 10 seconds
            setTimeout(() => resultDiv.textContent = "", 10000);

        } else {
            errorDiv.textContent = data.error || "Something went wrong.";
            // Keep error visible for 15 seconds
            setTimeout(() => errorDiv.textContent = "", 15000);
        }
    } catch (err) {
        errorDiv.textContent = "Error connecting to backend.";
        console.error(err);
        setTimeout(() => errorDiv.textContent = "", 10000);
    } finally {
        button.disabled = false;
        button.textContent = "Add Movie";
    }
});
</script>
